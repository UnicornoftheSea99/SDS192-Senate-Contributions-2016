---
title: "Put a real title here"
subtitle: "SDS 192: MP2"
author: 
- name: Julia Walker
  affiliation: Smith College
- name: Emily Rhyu
  affiliation: Smith College
- name: Sa'mya Wilson
  affiliation: Smith College
date: "`r format(Sys.Date(), '%B %e, %Y')`"
output: 
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    fig_width: 7
    fig_height: 6
    fig_caption: true
    theme: lumen
    df_print: paged
    code_folding: show
references:
- id: fec16
  type: article
  title: "fec16: Data Package for the 2016 United States Federal Elections"
  author: 
  - family: Tapal
    given: Marium
  - family: Gahwagy
    given: Rana
  - family: Ryan
    given: Irene
  - family: Baumer
    given: Benjamin S.
  issued:
    year: 2020
  publisher: CRAN
  url: https://CRAN.R-project.org/package=fec16
  notes: "R package version 0.1.3"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  echo = TRUE,
  warning = FALSE
)
library(tidyverse)
library(sds192)
library(ggplot2)
library(ggthemes)
library(dplyr)
library(scales)
```

## Introduction

What is this article about? 

This is how you make a footnote.[^github]

[^github]: Please see [our GitHub repository](https://github.com/sds192-i21/mp2-pacific-a) for complete code. 

You can cite references using parentheses or not. Sometimes you want to refer to the authors by name. 
For example, @fec16 provides the data. 
Other times, you want to cite something at the end of a sentence. 
Our analysis is based on data from the Federal Election Commission [@fec16].

If your data comes from a package, you can cite your data source using the information from the `citation()` function.

```{r}
citation("fec16")
```


## Loading the data

```{r, message=FALSE}
library(fec16)
```

To get the full `contributions` table, run this:

```{r, eval=FALSE}
contributions_all <- read_all_contributions()
```


```{r}
contributions_all <- read_all_contributions()
cali_candidates <- candidates %>%
  filter(cand_office_st=="CA" & cand_office == "S") 
comm_cand <- cali_candidates %>%
  left_join(contributions_all, by=c("cand_id"="cand_id"))%>%
  filter(transaction_tp=="24A" | transaction_tp=="24E")
```

```{r}
# what do transactions look like
ca_transactions <- comm_cand %>%
  group_by(transaction_tp) %>%
  summarize(num_transactions = n(),
            transaction_total = sum(transaction_amt))

#how many candidates
comm_cand %>%
  summarize(num_candidates = n_distinct(cand_name))

ggplot(data=ca_transactions, aes(x=transaction_tp, y=transaction_total, fill=transaction_tp))+
  geom_col()+
  scale_fill_manual(values = c("24A"="indianred1","24E"="seagreen1"), labels = c("24A (opposing)", "24E (supporting)" ))
```

```{r}
ggplot(data = comm_cand, aes(x= cand_name, y=transaction_amt, fill=transaction_tp))+
geom_bar(stat='identity')+
  scale_fill_manual(values = c("24A"="indianred1","24E"="seagreen1"), labels = c("24A (opposing)", "24E (supporting)" ))+
  scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x), labels = trans_format("log10", math_format(10^.x)))+
  labs(title = "Campaign Contributions",
       subtitle = "Senate candidates from CA in 2016 elections",
       fill = "Transaction Type") +
  ylab("Transaction Amount")+
  xlab("Candidate Name")+
   theme(legend.position=c(0.8, 0.8))+
  coord_flip()
```

```{r}
# filter data for Senate candidates from Nevada
nv_candidates <- candidates %>%
  filter(cand_office_st == "NV" & cand_office == "S")
#dim(nv_candidates)

nv_money <- nv_candidates %>%
  left_join(contributions_all, by=c("cand_id"="cand_id")) %>%
  filter(transaction_tp == "24A" | transaction_tp == "24E")%>%
  select(cand_name, cand_pty_affiliation, cand_election_yr, cand_office, transaction_tp, transaction_amt)
#dim(nv_money)
```

```{r}
# what do transactions look like
nv_transactions <- nv_money %>%
  group_by(transaction_tp) %>%
  summarize(num_transactions = n(), transaction_total = sum(transaction_amt))

# how many candidates
nv_money %>% 
  summarize(num_candidates = n_distinct(cand_name))

ggplot(data=nv_transactions, aes(x=transaction_tp, y=transaction_total, fill=transaction_tp))+
  geom_col()+
  scale_fill_manual(values = c("24A"="indianred1","24E"="seagreen1"), labels = c("24A (opposing)", "24E (supporting)" ))
```

```{r}
ggplot(data = nv_money, aes(x= cand_name, y=transaction_amt, fill=transaction_tp))+
  geom_bar(stat='identity') +
  scale_fill_manual(values = c("24A"="indianred1","24E"="seagreen1"), labels = c("24A (opposing)", "24E (supporting)" ))+
  scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x), labels = trans_format("log10", math_format(10^.x)))+
  labs(title = "Campaign Contributions",
       subtitle = "Senate candidates from NV in 2016 elections",
       fill = "Transaction Type") +
  ylab("Transaction Amount")+
  xlab("Candidate Name")+
   theme(legend.position=c(0.8, 0.2))+
  coord_flip()
```

## Analysis

What did you discover?

## Conclusion

What did you learn about the 2016 federal election cycle?

## Word count

```{r word_count, message=FALSE, echo=FALSE}
text_stats()
```

## Standards

In this assignment, we attempted the following [standards](https://beanumber.github.io/sds192/standards.html):

- `r standard_button("wrangling")`: We met the Wrangling standard because we...
- `r standard_button("relational")`: We met the Relational standard because we...
- `r standard_button("reshape")`: We met the Reshape standard because we...
- `r standard_button("aesthetics")`: We mastered the Aesthetics standard because we...
- `r standard_button("markdown")`: We mastered the R Markdown standard because we...
- `r standard_button("github")`: We mastered the GitHub standard because we...
- `r standard_button("context")`: We mastered the Context standard because we...
- `r standard_button("ethics")`: We mastered the Ethics standard because we...

## References
https://ballotpedia.org/United_States_Senate_election_in_California,_2016
https://www.reuters.com/article/us-usa-election-california-senate/california-poised-to-shut-out-republicans-from-u-s-senate-race-idUSKCN0YT16J
https://stackoverflow.com/questions/61068031/error-stat-count-can-only-have-an-x-or-y-aesthetic
http://www.sthda.com/english/wiki/ggplot2-axis-scales-and-transformations
https://stackoverflow.com/questions/38788357/change-bar-plot-colour-in-geom-bar-with-ggplot2-in-r
https://ballotpedia.org/United_States_Senate_election_in_Nevada,_2016